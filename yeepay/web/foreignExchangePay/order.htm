<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
</head>
<body>
<script type="text/javascript" src="../js/jquery.js"></script>
<script type="text/javascript">

</script>
<form id="orderForm" action='order.php' method='post'>
    <input type="hidden" name="details" id="details">
		<input type="hidden" name="hiddenSubOrder" id="hiddenSubOrder">
    <table>
        <tr>
            <td width=200>接口类型:网关购汇</td>
        </tr>

        <tr>
            <td width=200>订单号</td>
            <td><input type='text' name='requestId' id="requestId" value=''></td>
        </tr>
        <tr>
            <td width=200>订单金额</td>
            <td><input type='text' name='orderAmount' value='1000'>(分)</td>
        </tr>
        <tr>
            <td width=200>订单币种</td>
            <td><input type='text' name='orderCurrency' value='CNY'></td>
        </tr>
        <tr>
            <td width=200>购汇金额</td>
            <td><input type="text" name="amount" value="">(分)</td>
        </tr>
        <tr>
            <td width=200>购汇币种</td>
            <td><input type="text" name="currency" value="USD"></td>
        </tr>
        <tr>
            <td width=200>购汇用途</td>
            <td><input type="text" name="forUse" value="GOODSTRADE"></td>
        </tr>
        <tr>
            <td width=200>锁定牌价标识</td>
            <td><input type="text" name="listPriceToken" value=""></td>
        </tr>
        <tr>
            <td width=200>通知地址</td>
            <td><input type='text' name='notifyUrl' value=''></td>
        </tr>
        <tr>
            <td width=200>回调地址</td>
            <td><input type='text' name='callbackUrl' value=''></td>
        </tr>
        <tr>
            <td width=200>备注</td>
            <td><input type='text' name='remark' value='备注'></td>
        </tr>
        <tr>
            <td width=200>支付方式编码</td>
            <td><input type='text' name='paymentModeCode' value=''></td>
        </tr>
        <tr>
            <td width=200>微信公众号openId</td>
            <td><input type='text' name='openId' value=''></td>
        </tr>
        <tr>
            <td width=200>商品名称</td>
            <td width=200>商品数量</td>
            <td width=200>商品金额</td>
            <td width=200>收款人</td>
            <td width=200>商品描述</td>
        </tr>
        <tr class="product">
            <td><input type='text' name='productName' id="productName" value=''></td>
            <td><input type='text' name='quantity' value=''></td>
            <td><input type='text' name='productAmount' value=''></td>
            <td><input type='text' name='receiver' value=''></td>
            <td><input type='text' name='description' value=''></td>
        </tr>
        <tr>
            <td>
                <button type="button" onclick="add();">添加</button>
            </td>
            <td>
                <button type="button" onclick="del();">删除</button>
            </td>
        </tr>
		
		<tr>
				<td colspan="2"><font color="red">---------------------商户子订单信息----------------------</font></td>
			</tr>
			<tr >
				<td width=200>子订单号</td>
				<td width=200>金额</td>
			</tr>
			<tr class="subOrders">
				<td><input type='text' name='subRequestId' value=''></td>
				<td><input type='text' name='subOrderAmount' value=''>(分)</td>
			</tr>
			<tr >
				<td ><button type="button"  onclick="addSubOrder();">添加</button></td>
				<td ><button type="button"  onclick="delSubOrder();">删除</button></td>
			</tr>
        <tr id="payerName">
            <td width=200>付款人姓名</td>
            <td><input type='text' name='payerName' value='' onfocus="textFoucus()"></td>
        </tr>
        <tr id="payerIdType">
            <td width=200>证件类型</td>
            <td><input type='text' name='payerIdType' value='' onfocus="textFoucus()"></td>
        </tr>
        <tr id="payerIdNum">
            <td width=200>证件号码</td>
            <td><input type='text' name='payerIdNum' value='' onfocus="textFoucus()"></td>
        </tr>
        <tr id="bankCardNum">
            <td width=200>银行卡号</td>
            <td><input type='text' name='bankCardNum' value='' onfocus="textFoucus()"></td>
        </tr>
        <tr id="phoneNum">
            <td width=200>手机号码</td>
            <td><input type='text' name='phoneNum' value=''></td>
        </tr>
        <tr id="email">
            <td width=200>Email</td>
            <td><input type='text' name='email' value=''></td>
        </tr>
        <tr id="nationality">
            <td width=200>付款人国籍</td>
            <td><input type='text' name='nationality' value=''></td>
        </tr>
        <tr>
            <td width=200>收银台类型</td>
            <td><input type='text' name='cashierVersion' value=''></td>
        </tr>
        <tr>
            <td width=200>商户会员ID</td>
            <td><input type='text' name='merchantUserId' value=''></td>
        </tr>
        <tr>
            <td width=200>绑卡ID</td>
            <td><input type='text' name='bindCardId' value=''></td>
        </tr>

        <tr>
            <td colspan="2"><font
                    color="red">---------------------快捷直连时需要填银行卡号-----------------------------------</font></td>
        </tr>
        <tr>
            <td width=200>开户名</td>
            <td><input type='text' name='name' value=''></td>
        </tr>
        <tr>
            <td width=200>卡号</td>
            <td><input type='text' name='cardNo' value=''></td>
        </tr>
        <tr>
            <td width=200>cvv2</td>
            <td><input type='text' name='cvv2' value=''></td>
        </tr>
        <tr>
            <td width=200>身份证号</td>
            <td><input type='text' name='idNo' value=''></td>
        </tr>
        <tr>
            <td width=200>有效期yyyy-MM</td>
            <td><input type='text' name='expiryDate' value=''></td>
        </tr>
        <tr>
            <td width=200>手机号</td>
            <td><input type='text' name='mobileNo' value=''></td>
        </tr>
        <tr>
            <td width=200>clientIp</td>
            <td><input type='text' name='clientIp' value=''></td>
        </tr>
        <tr>
            <td width=200>订单超时时间</td>
            <td><input type='text' name='timeout' value=''></td>
        </tr>
        <tr>
            <td colspan="2"><input type='submit' name='' value='提交'></td>
        </tr>
    </table>
</form>
<script type="text/javascript">
    document.getElementById("requestId").value = new Date().valueOf();
</script>
<script type="text/javascript">
    $("#orderForm").submit(function () {
        var json = "[";
        $(".product").each(function (i) {
            var item = "{";
            item += "\"name\":\"" + $(this).find("input[name=productName]").val() + "\",";
            item += "\"quantity\":\"" + $(this).find("input[name=quantity]").val() + "\",";
            item += "\"amount\":\"" + $(this).find("input[name=productAmount]").val() + "\",";
            item += "\"receiver\":\"" + $(this).find("input[name=receiver]").val() + "\",";
            item += "\"description\":\"" + $(this).find("input[name=description]").val() + "\"";
            item = item + "}";
            if (i > 0) {
                json += ",";
            }
            json += item;
        });
        json = json + "]";
        $("#details").val(json);
        console.info(json);
		
			var json3 = "[";
			$(".subOrders").each(function(j){
				var str = "";
				str += $.trim($(this).find("select[name=subRequestId]").val());
				str += $.trim($(this).find("input[name=subOrderAmount]").val());
				if($.trim(str)=="") {
					return;//实现continue功能
				}
				var item3 = "{";
				item3+="\"requestId\":\""+$.trim($(this).find("input[name=subRequestId]").val())+"\",";
				item3+="\"orderAmount\":\""+$.trim($(this).find("input[name=subOrderAmount]").val())+"\"";
				item3 = item3 + "}";
				if(j>0){
					json3+=",";
				}
				json3+=item3;
			});
			json3=json3 + "]";
			$("#hiddenSubOrder").val(json3);
		
    });

    function add() {
        var p = $(".product:first");
        p.after(p.clone());
    }

    function del() {
        if ($(".product").length > 1) {
            $(".product:last").remove();
        }
    }
			function addSubOrder(){
			var p=$(".subOrders:last");
			p.after(p.clone());
		}

		function delSubOrder(){
			if($(".subOrders").length>1){
				$(".subOrders:last").remove();
			}
		}

</script>
</body>
</html>
